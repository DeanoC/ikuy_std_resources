name: tiny_imageformat

boards: 
 - host

cpus:
 - host

builder: 
 - zig

# libraries to be linked into this peice of software
libraries: 
 - vfile-zig

# non library dependencies (like host programs, asset processing etc.)
dependencies: [] 

actions:
 - fetch git git@github.com:DeanoC/tiny_imageformat.git zig

zig:
    link: |4
        const base_dir = "libs/tiny_imageformat/";
        const main_path = base_dir ++ "package.zig";
        const format_gen_build = @import("libs/tiny_imageformat/package.zig");
        const format_gen = format_gen_build.buildFormatGen(builder, executable.target, builder.standardReleaseOptions(), base_dir);
        executable.step.dependOn(&format_gen.step);
        const pkg = std.build.Pkg{ .name = library.name, .source = .{ .path = main_path } };
        executable.addPackage(pkg);